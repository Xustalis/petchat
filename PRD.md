# pet-chat 产品需求文档（PRD）

## 一、项目背景与目标

### 1.1 项目背景

在日常沟通中，大量高价值信息（情绪变化、关键约定、共同计划、长期话题）仅停留在聊天记录中，缺乏结构化整理与智能辅助。同时，现有聊天工具更多承担“信息传输”角色，而非“对话理解者”。

本项目 **pet-chat** 旨在作为一个个人实践型实验项目，探索 **AI 作为“第三方观察者”介入聊天场景** 的可行性，通过情绪感知、上下文理解与记忆机制，为聊天双方提供非侵入式的智能辅助。

### 1.2 项目目标

* 构建一个 **可运行、可使用、可重构** 的实验级聊天工具
* 验证以下核心假设：

  * AI 能否在不打断聊天的前提下理解对话环境
  * 情绪可视化是否能帮助用户更好感知聊天氛围
  * 聊天内容是否可以自然转化为计划、提醒与决策建议
* 为后续架构重构与功能扩展提供实践依据

### 1.3 产品阶段定位

* 产品阶段：**Experimental / 技术验证阶段**
* 使用范围：**熟人（朋友）小规模使用**
* 不追求商业化与大规模稳定性

---

## 二、用户与使用场景

### 2.1 用户角色定义

#### 房主（Host）

* 熟悉基础技术操作
* 配置并提供 AI API Key
* 启动聊天服务，作为 AI 请求转发与决策节点
* 通常是对项目本身有兴趣的参与者

#### 访客（Guest）

* 无需任何技术配置
* 通过房主提供的 IP / 端口接入
* 专注于聊天与 AI 辅助体验

### 2.2 核心使用场景

* 朋友之间的日常聊天
* 共同讨论出游、聚餐、学习或项目计划
* 情绪波动较明显的聊天（争论、安慰、玩笑）
* 长时间、多次聊天，希望 AI 记住“你们在聊什么”

---

## 三、产品核心理念

### 3.1 AI 的角色定位

AI 并非聊天参与者，而是：

> **一个“旁观并理解这段对话的智能宠物”**

其职责包括：

* 感知整体聊天情绪环境
* 观察对话发展趋势
* 记录并提炼关键信息
* 在合适时机给出辅助建议

AI 不直接替用户发言，不主导聊天内容。

### 3.2 情绪识别设计原则

* 情绪识别对象：**整个聊天环境，而非某一方立场**
* 情绪是“趋势”而非“判决”
* 当置信度不足时，保持中性反馈

宠物代表的是“这段对话的状态”，而不是任何一个用户的情绪。

---

## 四、功能需求说明

### 4.1 基础聊天功能（MVP）

* 点对点 P2P 通信（Host-Guest 模式）
* 文本消息发送与接收
* Emoji 支持
* 消息时间戳展示
* 聊天记录本地存储（SQLite）

非目标（v1 不做）：

* 多人群聊
* 文件传输
* 消息撤回 / 已读状态

---

### 4.2 情绪宠物系统（核心功能）

#### 4.2.1 功能目标

* 实时反映聊天氛围
* 提供非语言化的情绪反馈
* 减少用户对“情绪判断文字提示”的抵触

#### 4.2.2 情绪识别逻辑

* 分析最近 N 条（默认 3–5 条）聊天内容

* 情绪维度示例：

  * 平和 / 轻松
  * 愉快 / 兴奋
  * 紧张 / 焦躁
  * 消极 / 冲突

* 情绪结果以概率或权重形式存在

#### 4.2.3 表现形式

* UI 中常驻宠物组件

* 宠物通过：

  * 表情
  * 动作
  * 状态提示
    反映当前聊天环境

* 不显示明确的“你很生气”文本判断

---

### 4.3 对话记忆与关键信息提取

#### 4.3.1 记忆内容类型

* 共同提到的重要事件（如出游、考试、截止日期）
* 长期反复出现的话题
* 已达成的明确约定

#### 4.3.2 设计原则

* 记忆是摘要性的，而非完整聊天复制
* 默认仅本地保存
* 用户可查看、清空或忽略记忆

---

### 4.4 决策与计划辅助系统

#### 4.4.1 触发条件

* 识别特定语义场景：

  * 时间（明天、下周、周末）
  * 行为（出去玩、安排、计划）

#### 4.4.2 表现形式

* 侧边栏“建议卡片”
* 内容示例：

  * 简要行程建议
  * 时间安排草案
  * 可执行清单

#### 4.4.3 交互规则

* AI 不自动插入聊天内容
* 用户需主动点击“采用”
* 采用后内容可复制到输入框或保存

---

### 4.5 AI 触发机制（实验方案）

| 等级      | 描述     | 技术方式      | 目的     |
| ------- | ------ | --------- | ------ |
| Level 1 | 实时情绪监听 | 本地轻量模型    | 宠物状态驱动 |
| Level 2 | 意图识别   | 关键词 + LLM | 生成建议卡片 |
| Level 3 | 显式调用   | `/ai` 或按钮 | 深度决策支持 |

---

## 五、技术实现概述

### 5.1 架构说明

* 通信模式：Host-Guest P2P
* Host：

  * 聊天服务监听
  * AI 请求转发
  * 决策逻辑处理
* Guest：

  * UI 展示
  * 聊天输入输出

### 5.2 技术选型

* 语言：Python 3.10+
* UI：PyQt6
* AI 接口：OpenAI API 兼容协议
* 本地存储：SQLite
* 打包：Nuitka

---

## 六、隐私与安全设计

* 聊天记录仅保存在本地
* AI 请求仅发送必要上下文
* 不使用中转服务器
* 明确标注：实验项目，不做商业化数据采集

---

## 七、风险与限制

* 情绪识别可能存在误判
* 网络连接依赖 Host 稳定性
* 不适合陌生人社交场景

---

## 八、后续演进方向（非 v1）

* 多轮长期记忆机制
* 宠物成长与性格系统
* 插件化 AI 模块
* 架构重构（引入可选服务器）

---

## 九、项目定位总结

pet-chat 是一个 **用于探索 AI 对话理解与情绪感知能力的实践型项目**，重点不在于取代现有聊天工具，而在于验证：

> AI 是否可以作为“理解你们在聊什么的第三者”，在不打扰对话的前提下提供真实价值。
